---
layout: default
title: "Yocto ARM32 Live555 테스트 환경 구축 가이드"
description: "Yocto ARM32 Live555 테스트 환경 구축 가이드"
author: "김명환"
date: 2025-11-02
category: "검토"
cache-control: no-cache
expires: 0
pragma: no-cache
---

## Yocto ARM32 Live555 테스트 환경 구축 가이드

이 가이드는 NXP BSP의 불안정성 문제를 우회하고, **RTSP 스트리밍 테스트**에 필요한 핵심 패키지(`live555`, `alsa-utils`, `mpg123`)를 포함하는 안정적인 32-bit ARM 이미지를 빌드하는 과정을 담고 있습니다.

-----

### 1\. 환경 개요 및 최종 목표

| 항목 | 설정 값 | 목적 |
| :--- | :--- | :--- |
| **Yocto 버전** | Scarthgap (5.0) | 사용 중인 Poky 환경 버전 |
| **타겟 머신** | `qemuarm` | 안정적인 **32-bit ARM QEMU** 환경 제공 (i.MX 6와 아키텍처 일치) |
| **추가 패키지** | `live555`, `alsa-utils`, `alsa-lib`, `mpg123` | RTSP 스트리밍 및 오디오 재생 기능 구현 |
| **필수 레이어** | `meta-oe`, `meta-multimedia`, `meta-python` | `live555` 레시피 및 관련 의존성 제공 |

-----

### 2\. 불안정 요소 정리 (NXP 레이어 제거)

이전 단계에서 오류를 유발했던 NXP 관련 레이어 잔여 설정을 빌드 환경에서 완전히 분리합니다.

```bash
# 빌드 디렉토리로 이동 (필요한 경우)
cd ~/DATA/Dev/Work/yocto-test/poky/build-test

# 1. NXP 레이어 비활성화 및 잔여 폴더 삭제
# NXP 레이어가 활성화되어 있었다면, 아래 명령으로 제거
bitbake-layers remove-layer ../meta-freescale-3rdparty
bitbake-layers remove-layer ../meta-freescale
# (의존성 오류는 무시하고 진행합니다.)

# Poky 루트 디렉토리로 이동하여 클론된 NXP 폴더 삭제
cd .. 
rm -rf meta-freescale meta-freescale*
source oe-init-build-env build-test

# 2. bblayers.conf에서 경로 수동 정리
# vi conf/bblayers.conf를 열어 'meta-freescale' 및 'meta-freescale-3rdparty' 경로를 수동으로 제거합니다.
```

-----

### 3\. 필수 레이어 (`meta-openembedded`) 추가

`live555`를 포함한 멀티미디어 패키지 레시피를 가져오기 위해 `meta-openembedded` 레이어 그룹을 클론하고 등록합니다.

#### A. 레이어 클론

```bash
# Poky 루트 디렉토리 (poky/)에서 실행
cd ..
git clone -b scarthgap git://git.openembedded.org/meta-openembedded
source oe-init-build-env build-test
```

#### B. 서브 레이어 등록 (순서 중요)

`meta-multimedia`의 의존성 문제를 해결하기 위해 **`meta-oe` → `meta-python` → `meta-multimedia`** 순서로 등록합니다.

```bash
# meta-openembedded의 필수 서브 레이어 등록
bitbake-layers add-layer ../meta-openembedded/meta-oe
bitbake-layers add-layer ../meta-openembedded/meta-python
bitbake-layers add-layer ../meta-openembedded/meta-multimedia
```

-----

### 4\. `local.conf` 설정 (최종)

`conf/local.conf` 파일을 열고 다음 설정을 최종적으로 확인/수정하여 저장합니다.

```bash
# vi conf/local.conf
```

**`conf/local.conf` 최종 내용:**

```conf
# -----------------------------------------------------------
# 32-bit ARM QEMU 타겟으로 변경
MACHINE = "qemuarm"

# QEMU 부팅을 위한 이미지 포맷 추가
IMAGE_FSTYPES:append = " ext4.gz"

# 멀티미디어 패키지 및 라이브러리 추가 (RTSP 테스트를 위함)
IMAGE_INSTALL:append = " alsa-utils alsa-lib mpg123 live555"

# 이미지 크기 확장 (용량 확보)
IMAGE_ROOTFS_SIZE = "409600"

# NXP 관련 설정 (ACCEPT_FSL_EULA 등)은 모두 제거하거나 주석 처리
# -----------------------------------------------------------
```

-----

### 5\. 이미지 빌드 및 테스트

최종 설정을 저장한 후, 32-bit ARM 이미지를 빌드합니다.

```bash
sw1@notebook-sw1:~/DATA/Dev/Work/yocto-test/poky/build-test$ bitbake core-image-minimal
```

빌드가 완료되면, 다음 명령어로 QEMU 환경에서 이미지 부팅 및 Live555 테스트를 진행할 수 있습니다.

```bash
# 빌드된 이미지 경로 (빌드 환경에 따라 달라질 수 있음)
# tmp/deploy/images/qemuarm/core-image-minimal-qemuarm.ext4.gz

# 32-bit ARM QEMU 실행
runqemu qemuarm core-image-minimal
```
